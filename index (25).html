<!doctype html>
<html lang="sv" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bredbands- och TV-kompassen – Sverige</title>
  <style>
    :root{
      --bg:#0f1115;--card:#141820;--muted:#9aa3b2;--text:#e9edf5;--accent:#7aa2ff;--line:#202736;
      --chip:#242b3a;--glow-color: rgba(122,162,255,.28);--glow-bg: rgba(122,162,255,.08)
    }
    html[data-theme="light"]{
      --bg:#f6f7fb;--card:#ffffff;--muted:#5b6575;--text:#141820;--accent:#3b6aff;--line:#e4e7ef;
      --chip:#eef2ff;--glow-color: rgba(59,106,255,.28);--glow-bg: rgba(59,106,255,.08)
    }

    body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    header{padding:20px 16px;border-bottom:1px solid var(--line);display:flex;align-items:center;justify-content:space-between;gap:12px}
    header h1{margin:0;font-size:18px;font-weight:700}
    header .right{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    main{max-width:1100px;margin:0 auto;padding:18px;display:grid;grid-template-columns: 1fr 360px;gap:18px}
    @media (max-width: 980px){main{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:14px}

    /* Två kolumner i tjänstelistan: vänster (bredband+sport), höger (tv+streaming+film) */
    .columns{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:14px}
    @media (max-width:720px){.columns{grid-template-columns:1fr}}

    .service{display:flex;flex-direction:column;gap:10px}
    .service header{display:flex;justify-content:space-between;align-items:center;border:0;padding:0}
    .service h2{font-size:15px;margin:0}
    .muted{color:var(--muted)}
    .plans{display:grid;gap:8px;margin-bottom:6px}
    .plan{
      display:flex;align-items:center;justify-content:space-between;
      border:1px solid var(--line);border-radius:12px;padding:10px;
      transition: box-shadow .18s ease, border-color .18s ease, transform .06s ease, background .18s ease;
      background: transparent;
    }
    .plan:hover{transform: translateY(-1px)}
    .plan label{display:flex;align-items:center;gap:10px;cursor:pointer}
    .plan input{accent-color: var(--accent)}
    .price{font-weight:700}
    .chip{background:var(--chip);border:1px dashed var(--line);color:var(--muted);padding:2px 8px;border-radius:999px;font-size:11px}
    .total-card .row{display:flex;justify-content:space-between;margin:8px 0}
    .total-card .grand{font-size:22px;font-weight:800}
    .kicker{font-size:12px}
    .chips{display:flex;flex-wrap:wrap;gap:6px}
    .btn{background:var(--accent);color:#fff;border:0;border-radius:12px;padding:10px 12px;font-weight:700;cursor:pointer}
    .btn.secondary{background:transparent;color:inherit;border:1px solid var(--line)}
    .note{font-size:12px;color:var(--muted)}
    .hr{border:0;border-top:1px dashed var(--line);margin:8px 0}

    .selected{border-color: var(--accent);box-shadow: 0 0 0 2px var(--glow-color);background: var(--glow-bg)}
    .subhead{font-size:12px;color:var(--muted);margin-top:-2px}
  </style>
</head>
<body>
  <header>
    <h1>Bredbands- och TV-kompassen – Sverige</h1>
    <div class="right">
      <label class="muted">Extra moms/påslag %
        <input type="number" id="vat" value="0" min="0" max="50" step="1" style="width:84px"/>
      </label>

      <label class="theme-toggle" style="display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line);border-radius:999px;padding:6px 10px;cursor:pointer;font-weight:600">
        <span id="themeLabel">Mörkt läge</span>
        <input id="themeSwitch" type="checkbox" aria-label="Växla tema"
               style="appearance:none;width:34px;height:18px;background:var(--line);border-radius:999px;position:relative;outline:none;cursor:pointer">
      </label>

      <button id="resetBtn" class="btn secondary">Återställ</button>
    </div>
  </header>

  <main>
    <!-- Tjänster (vänster sektion) -->
    <section class="card">
      <div class="columns">
        <!-- VÄNSTER KOLUMN: Bredband + Sport -->
        <div id="leftCol"></div>
        <!-- HÖGER KOLUMN: TV + Streaming + Film -->
        <div id="rightCol"></div>
      </div>
    </section>

    <!-- Summering (höger sektion) -->
    <aside class="card total-card">
      <h2 style="margin-top:0">Summering</h2>
      <div class="chips" id="selectedChips"></div>

      <div class="row"><div>Summa per månad</div><div id="monthly" class="grand" aria-live="polite">0 SEK</div></div>
      <div class="row kicker"><div>Varav extra moms/påslag</div><div id="vatAmt" aria-live="polite">0 SEK</div></div>
      <hr class="hr">
      <div class="row"><div>Summa per år (12×)</div><div id="yearly" aria-live="polite">0 SEK</div></div>
      <div class="row kicker"><div>Per vecka</div><div id="perWeek" aria-live="polite">0 SEK</div></div>
      <hr class="hr">
      <div class="row"><div>Valda paket</div><div id="count" aria-live="polite">0</div></div>
      <p class="note">Tips: kopiera summeringen och klistra in i mejl eller offert.</p>
      <button id="copyBtn" class="btn" style="width:100%">Kopiera summering</button>
    </aside>
  </main>

<script>
/* === KONFIG – kategoriupplägg & prisnivåer (kan justeras) ===
   En (1) vald plan per kategori (service.id). Kategorier kan kombineras. */
const CONFIG = {
  currency: 'SEK',
  leftOrder:  ['broadband','sport'],          // renderas i vänster kolumn
  rightOrder: ['tv','streaming','film'],      // renderas i höger kolumn
  services: [
    /* Bredband – välj en hastighet */
    { id:'broadband', name:'Bredband',
      plans: [
        { id:'bb150', label:'150 Mbit/s',  priceSEK:349 },
        { id:'bb300', label:'300 Mbit/s',  priceSEK:389 },
        { id:'bb500', label:'500 Mbit/s',  priceSEK:439 },
        { id:'bb600', label:'600 Mbit/s',  priceSEK:489 },
        { id:'bb1000',label:'1000 Mbit/s', priceSEK:599 },
      ]
    },

    /* TV – paket (Mini, Mellan, Max, Mycket) */
    { id:'tv', name:'TV-paket',
      plans: [
        { id:'tvMini',   label:'Mini',   priceSEK:249 },
        { id:'tvMellan', label:'Mellan', priceSEK:399 },
        { id:'tvMax',    label:'Max',    priceSEK:499 },
        { id:'tvMycket', label:'Mycket', priceSEK:549 },
      ]
    },

    /* Streaming – Mer, Maxad */
    { id:'streaming', name:'Streaming',
      plans: [
        { id:'strMer',   label:'Mer',    priceSEK:399 },
        { id:'strMaxad', label:'Maxad',  priceSEK:499 },
      ]
    },

    /* Sport – kan kombineras med TV/Streaming, men här väljer man ett sportpaket */
    { id:'sport', name:'Sportpaket',
      plans: [
        { id:'sportBas',  label:'Sport Bas',  priceSEK:199 },
        { id:'sportStor', label:'Sport Stor', priceSEK:299 },
        { id:'sportTotal',label:'Sport Total',priceSEK:399 },
      ]
    },

    /* Film – tilläggs-/filmkategori */
    { id:'film', name:'Filmpaket',
      plans: [
        { id:'filmBas',  label:'Film Bas',  priceSEK:149 },
        { id:'filmStor', label:'Film Stor', priceSEK:249 },
        { id:'hboMax',   label:'HBO Max',   priceSEK:149 },
      ]
    },
  ]
};

let selectedPlans = {}; // { serviceId: planId }

/* === Utils === */
const fmt = (value) => `${value.toFixed(0)} SEK`;
const $ = (sel, root=document)=>root.querySelector(sel);
const $$ = (sel, root=document)=>[...root.querySelectorAll(sel)];

/* === Rendering av en kategori (service) === */
function renderServiceCard(service){
  const card = document.createElement('div');
  card.className = 'card service';

  const plansHTML = service.plans.map(p=>{
    const radioId = `${service.id}-${p.id}`;
    return `
      <div class="plan">
        <label for="${radioId}">
          <input type="radio" name="${service.id}" id="${radioId}" value="${p.id}">
          <div>${p.label}</div>
        </label>
        <div class="price">${fmt(p.priceSEK)}</div>
      </div>`;
  }).join('');

  card.innerHTML = `
    <header>
      <h2>${service.name}</h2>
      <span class="muted">Välj paket</span>
    </header>
    <div class="plans">${plansHTML}</div>
    <div class="note">Valt: <span id="sel-${service.id}">Inget</span></div>
  `;

  // lyssna på ändringar
  $$(`input[type=radio][name="${service.id}"]`, card).forEach(input=>{
    input.addEventListener('change', ()=>{
      selectedPlans[service.id] = input.value;
      highlightSelected(service.id, input.id, card);
      const plan = service.plans.find(p=>p.id===input.value);
      card.querySelector('#sel-'+service.id).textContent = plan ? plan.label : 'Inget';
      updateTotals();
    });
  });

  return card;
}

/* Markera vald plan inom kategorin */
function highlightSelected(serviceId, pickedRadioId, scope){
  $$('.plan', scope).forEach(el => el.classList.remove('selected'));
  const picked = scope.querySelector('#'+CSS.escape(pickedRadioId))?.closest('.plan');
  if (picked) picked.classList.add('selected');
}

/* === Rendera hela layouten: vänster/höger kolumn enligt order === */
function renderColumns(){
  const leftWrap = document.getElementById('leftCol');
  const rightWrap = document.getElementById('rightCol');
  leftWrap.innerHTML = '';
  rightWrap.innerHTML = '';

  const servicesById = Object.fromEntries(CONFIG.services.map(s=>[s.id,s]));
  CONFIG.leftOrder.forEach(id => leftWrap.appendChild(renderServiceCard(servicesById[id])));
  CONFIG.rightOrder.forEach(id => rightWrap.appendChild(renderServiceCard(servicesById[id])));

  updateTotals();
}

/* Summeringar */
function updateTotals(){
  let monthlySEK = 0;
  const chipsWrap = document.getElementById('selectedChips');
  chipsWrap.innerHTML = '';

  Object.entries(selectedPlans).forEach(([sid,pid])=>{
    const svc = CONFIG.services.find(s=>s.id===sid);
    const plan = svc?.plans.find(p=>p.id===pid);
    if(plan){
      monthlySEK += plan.priceSEK||0;
      const chip = document.createElement('span');
      chip.className='chip';
      chip.textContent = `${svc.name}: ${plan.label}`;
      chipsWrap.appendChild(chip);
    }
  });

  const vatPct = parseFloat(document.getElementById('vat').value)||0;
  const vatAmtSEK = monthlySEK * (vatPct/100);
  const monthlyWithVAT = monthlySEK + vatAmtSEK;

  document.getElementById('monthly').textContent = fmt(monthlyWithVAT);
  document.getElementById('vatAmt').textContent = fmt(vatAmtSEK);
  document.getElementById('yearly').textContent = fmt(monthlyWithVAT*12);
  document.getElementById('perWeek').textContent = fmt((monthlyWithVAT*12/52));
  document.getElementById('count').textContent = Object.keys(selectedPlans).length;
}

/* Kopiera summering */
function copySummary(){
  let lines = [];
  lines.push('Bredbands- och TV-kompassen – Summering');
  lines.push('');

  Object.entries(selectedPlans).forEach(([sid,pid])=>{
    const svc = CONFIG.services.find(s=>s.id===sid);
    const plan = svc?.plans.find(p=>p.id===pid);
    if(plan) lines.push(`• ${svc.name} — ${plan.label}: ${fmt(plan.priceSEK)}/månad`);
  });

  const total = document.getElementById('monthly').textContent;
  lines.push('');
  lines.push(`Totalt: ${total}`);
  navigator.clipboard.writeText(lines.join('\n')).then(()=>{
    const btn = document.getElementById('copyBtn');
    const old = btn.textContent;
    btn.textContent = 'Kopierat!';
    setTimeout(()=>btn.textContent = old, 1200);
  });
}

/* Återställ allt */
function resetAll(){
  selectedPlans = {};
  document.querySelectorAll('input[type=radio]').forEach(r=>r.checked=false);
  document.querySelectorAll('.plan.selected').forEach(el=>el.classList.remove('selected'));
  CONFIG.services.forEach(s=>{
    const el = document.getElementById('sel-'+s.id);
    if(el) el.textContent = 'Inget';
  });
  updateTotals();
}

/* Tema – toggle + persistence */
function initTheme(){
  const saved = localStorage.getItem('compass-theme');
  const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
  const initial = saved || (prefersLight ? 'light' : 'dark');
  document.documentElement.setAttribute('data-theme', initial);
  const isLight = initial === 'light';
  const sw = document.getElementById('themeSwitch');
  sw.checked = isLight;
  document.getElementById('themeLabel').textContent = isLight ? 'Ljust läge' : 'Mörkt läge';

  sw.addEventListener('change', ()=>{
    const theme = sw.checked ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', theme);
    document.getElementById('themeLabel').textContent = sw.checked ? 'Ljust läge' : 'Mörkt läge';
    localStorage.setItem('compass-theme', theme);
  });
}

/* Init */
renderColumns();
initTheme();

document.getElementById('vat').addEventListener('input', updateTotals);
document.getElementById('copyBtn').addEventListener('click', copySummary);
document.getElementById('resetBtn').addEventListener('click', resetAll);
</script>
</body>
</html>
